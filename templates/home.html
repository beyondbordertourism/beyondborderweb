{% extends "base.html" %}

{% block title %}Beyond Borders - Your Next Destination Awaits{% endblock %}

{% block head_styles %}
<style>
    /* Countries grid styles (reused from countries page) */
    .countries-section {
        background: linear-gradient(to bottom, #f8fafc 0%, #ffffff 100%);
        padding-top: 2rem;
        padding-bottom: 3rem;
    }

    .countries-section .country-card {
        border-radius: 16px;
        overflow: hidden;
    }

    .country-media {
        height: 140px;
        position: relative;
        background-size: cover;
        background-position: center;
    }

    .country-media-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(to bottom right, rgba(0, 0, 0, 0.15), rgba(0, 0, 0, 0.05));
    }

    .country-flag-bubble {
        position: absolute;
        left: 14px;
        bottom: -18px;
        width: 56px;
        height: 56px;
        border-radius: 14px;
        background: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 28px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
    }

    .country-media .visa-status-badge {
        position: absolute;
        right: 12px;
        bottom: 12px;
        padding: 0.5rem 0.9rem;
        font-size: 0.75rem;
    }

    .countries-section .country-card-content {
        padding: 1.25rem 1.25rem 1.25rem 1.25rem;
        padding-top: 2.25rem;
    }

    .country-meta {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 0.75rem;
    }

    .country-region-chip {
        background: #f1f5f9;
        color: #475569;
        padding: 0.25rem 0.6rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .countries-section .country-card-footer {
        margin-top: 1rem;
        padding-top: 1rem;
    }

    /* Mobile Carousel Styles */
    .countries-carousel-mobile {
        position: relative;
        width: 100%;
        overflow: hidden;
    }

    .carousel-container {
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }

    .carousel-container::-webkit-scrollbar {
        display: none;
    }

    .carousel-track {
        display: flex;
        gap: 1rem;
        padding: 0.5rem;
        scroll-snap-type: x mandatory;
    }

    .carousel-track .country-card {
        flex: 0 0 85%;
        max-width: 85%;
        scroll-snap-align: center;
    }

    .carousel-dots {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-top: 1.5rem;
        padding: 0 1rem;
    }

    .carousel-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #cbd5e1;
        transition: all 0.3s ease;
        cursor: pointer;
    }

    .carousel-dot.active {
        background: linear-gradient(135deg, #14b8a6, #0891b2);
        width: 24px;
        border-radius: 4px;
    }

    /* Show grid on desktop, carousel on mobile */
    @media (min-width: 769px) {
        .countries-carousel-mobile {
            display: none !important;
        }

        .countries-grid-desktop {
            display: grid !important;
        }
    }

    @media (max-width: 768px) {
        .countries-grid-desktop {
            display: none !important;
        }

        .countries-carousel-mobile {
            display: block !important;
        }

        .carousel-track .country-card {
            flex: 0 0 90%;
            max-width: 90%;
        }
    }

    @media (max-width: 480px) {
        .carousel-track .country-card {
            flex: 0 0 95%;
            max-width: 95%;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="hero-klook">
    <div class="hero-klook-left">
        <div class="city-carousel">
            <!-- Countries will be loaded dynamically -->
        </div>
    </div>
    <div class="hero-klook-right">
        <div class="search-and-filter-klook">
            <form action="/search" method="GET" class="search-box-klook" autocomplete="off">
                <i class="fas fa-search"></i>
                <input type="text" name="q" id="search-input" placeholder="Search for a country...">
                <button type="submit" class="search-button-klook">Search</button>
            </form>
            <div id="search-results-klook" class="search-results-klook"></div>
            <div class="filter-buttons-klook">
                <button><i class="fas fa-file-alt"></i> Visa Application</button>
                <button><i class="fas fa-check-circle"></i> Document Check</button>
                <button><i class="fas fa-globe-americas"></i> E-Visa Services</button>
            </div>
        </div>
    </div>
</div>

<!-- Countries Grid (moved from Countries page) -->
<section class="countries-section py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Loading State -->
        <div id="homeCountriesLoading" class="text-center py-16">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div>
            <p class="mt-6 text-gray-600 text-lg">Loading countries...</p>
        </div>

        <!-- Desktop Grid View -->
        <div id="homeCountriesGrid"
            class="countries-grid-desktop grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
            style="display: none;"></div>

        <!-- Mobile Carousel View -->
        <div id="homeCountriesCarousel" class="countries-carousel-mobile" style="display: none;">
            <div class="carousel-container">
                <div class="carousel-track" id="carouselTrack"></div>
            </div>
            <div class="carousel-dots" id="carouselDots"></div>
        </div>
    </div>

</section>


<!-- Mission Statement Section - Enhanced -->
<section class="py-12 bg-gradient-to-br from-teal-50 via-blue-50 to-indigo-50 relative overflow-hidden">
    <!-- Animated Background Elements -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div
            class="absolute top-10 left-10 w-72 h-72 bg-teal-200 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob">
        </div>
        <div
            class="absolute top-20 right-10 w-72 h-72 bg-blue-200 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000">
        </div>
        <div
            class="absolute -bottom-8 left-20 w-72 h-72 bg-indigo-200 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000">
        </div>
    </div>

    <!-- Floating Icons -->
    <div class="absolute top-16 left-16 text-teal-300 opacity-30 animate-float">
        <i class="fas fa-plane text-4xl"></i>
    </div>
    <div class="absolute top-32 right-24 text-blue-300 opacity-30 animate-float animation-delay-1000">
        <i class="fas fa-passport text-3xl"></i>
    </div>
    <div class="absolute bottom-24 left-32 text-indigo-300 opacity-30 animate-float animation-delay-2000">
        <i class="fas fa-globe-americas text-3xl"></i>
    </div>
    <div class="absolute bottom-32 right-16 text-teal-300 opacity-30 animate-float animation-delay-3000">
        <i class="fas fa-map-marked-alt text-3xl"></i>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <!-- Main Mission Card -->
        <div
            class="bg-white/80 backdrop-blur-lg rounded-3xl p-8 md:p-10 shadow-2xl border border-white/50 relative overflow-hidden">
            <!-- Decorative corner elements -->
            <div
                class="absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-teal-400/10 to-transparent rounded-bl-full">
            </div>
            <div
                class="absolute bottom-0 left-0 w-40 h-40 bg-gradient-to-tr from-blue-400/10 to-transparent rounded-tr-full">
            </div>

            <div class="text-center relative z-10">
                <!-- Icon Group -->
                <div class="flex items-center justify-center gap-4 mb-4">
                    <div
                        class="w-16 h-16 bg-gradient-to-br from-teal-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg transform hover:scale-110 transition-transform duration-300 animate-pulse-slow">
                        <i class="fas fa-compass text-2xl text-white"></i>
                    </div>
                </div>

                <!-- Heading -->
                <div class="mb-4">

                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-3 leading-tight">
                        Our <span
                            class="bg-gradient-to-r from-teal-600 to-blue-600 bg-clip-text text-transparent">Mission</span>
                    </h2>
                    <div class="w-24 h-1 bg-gradient-to-r from-teal-500 to-blue-500 mx-auto rounded-full"></div>
                </div>

                <!-- Main Mission Text -->
                <p class="text-lg md:text-xl text-gray-700 leading-relaxed mb-6 max-w-4xl mx-auto font-medium">
                    To <span class="text-teal-600 font-bold">simplify the visa process</span> so you can focus on what
                    truly matters:
                    <span class="text-blue-600 font-bold">your journey</span>. From form filling to embassy appointments
                    â€”
                    we handle the details so you don't have to.
                </p>

                <!-- Quote -->
                <div
                    class="bg-gradient-to-r from-teal-50 to-blue-50 rounded-2xl p-4 mb-6 border-l-4 border-teal-500 max-w-3xl mx-auto">
                    <i class="fas fa-quote-left text-teal-400 text-xl mb-2"></i>
                    <p class="text-base text-gray-700 italic leading-relaxed">
                        We don't just process visas â€” we build relationships, answer every question, and go the extra
                        mile,
                        so your journey begins with confidence.
                    </p>
                    <i class="fas fa-quote-right text-blue-400 text-xl mt-2 float-right"></i>
                </div>

                <!-- Feature Highlights -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                    <!-- Feature 1 -->
                    <div
                        class="group p-4 rounded-2xl bg-gradient-to-br from-teal-50 to-teal-100/50 hover:from-teal-100 hover:to-teal-200/50 transition-all duration-300 transform hover:-translate-y-2 hover:shadow-xl">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-teal-500 to-teal-600 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300 shadow-lg">
                            <i class="fas fa-hands-helping text-xl text-white"></i>
                        </div>
                        <h4 class="text-base font-bold text-gray-900 mb-1">Personalized Support</h4>
                        <p class="text-sm text-gray-600 leading-relaxed">
                            Dedicated assistance tailored to your unique travel needs and requirements
                        </p>
                    </div>

                    <!-- Feature 2 -->
                    <div
                        class="group p-4 rounded-2xl bg-gradient-to-br from-blue-50 to-blue-100/50 hover:from-blue-100 hover:to-blue-200/50 transition-all duration-300 transform hover:-translate-y-2 hover:shadow-xl">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300 shadow-lg">
                            <i class="fas fa-shield-alt text-xl text-white"></i>
                        </div>
                        <h4 class="text-base font-bold text-gray-900 mb-1">Expert Guidance</h4>
                        <p class="text-sm text-gray-600 leading-relaxed">
                            Years of experience ensuring your application is complete and professional
                        </p>
                    </div>

                    <!-- Feature 3 -->
                    <div
                        class="group p-4 rounded-2xl bg-gradient-to-br from-indigo-50 to-indigo-100/50 hover:from-indigo-100 hover:to-indigo-200/50 transition-all duration-300 transform hover:-translate-y-2 hover:shadow-xl">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300 shadow-lg">
                            <i class="fas fa-clock text-xl text-white"></i>
                        </div>
                        <h4 class="text-base font-bold text-gray-900 mb-1">Time-Saving Process</h4>
                        <p class="text-sm text-gray-600 leading-relaxed">
                            Streamlined workflows that get you from application to approval faster
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Add custom animations -->
<style>
    @keyframes blob {

        0%,
        100% {
            transform: translate(0, 0) scale(1);
        }

        33% {
            transform: translate(30px, -50px) scale(1.1);
        }

        66% {
            transform: translate(-20px, 20px) scale(0.9);
        }
    }

    @keyframes float {

        0%,
        100% {
            transform: translateY(0px);
        }

        50% {
            transform: translateY(-20px);
        }
    }

    @keyframes pulse-slow {

        0%,
        100% {
            opacity: 1;
        }

        50% {
            opacity: 0.8;
        }
    }

    .animate-blob {
        animation: blob 7s infinite;
    }

    .animate-float {
        animation: float 3s ease-in-out infinite;
    }

    .animate-pulse-slow {
        animation: pulse-slow 3s ease-in-out infinite;
    }

    .animation-delay-1000 {
        animation-delay: 1s;
    }

    .animation-delay-2000 {
        animation-delay: 2s;
    }

    .animation-delay-3000 {
        animation-delay: 3s;
    }

    .animation-delay-4000 {
        animation-delay: 4s;
    }
</style>

<!-- FAQ Section -->
<section id="faq" class="py-20 bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50 relative overflow-hidden">
    <!-- Animated Background Elements -->
    <div class="absolute top-0 left-0 w-full h-full opacity-5">
        <div class="absolute top-20 left-20 w-32 h-32 bg-teal-300 rounded-full animate-pulse"></div>
        <div class="absolute top-40 right-32 w-24 h-24 bg-blue-300 rounded-full animate-pulse"
            style="animation-delay: 1s;"></div>
        <div class="absolute bottom-32 left-40 w-28 h-28 bg-indigo-300 rounded-full animate-pulse"
            style="animation-delay: 2s;"></div>
        <div class="absolute bottom-20 right-20 w-20 h-20 bg-slate-300 rounded-full animate-pulse"
            style="animation-delay: 3s;"></div>
    </div>

    <!-- Floating Geometric Shapes -->
    <div class="absolute top-16 right-16 w-16 h-16 border-2 border-teal-200 rotate-45 animate-spin-slow opacity-20">
    </div>
    <div class="absolute bottom-24 left-24 w-12 h-12 border-2 border-blue-200 opacity-30 animate-bounce-slow"></div>

    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <!-- Enhanced Section Header -->
        <div class="text-center mb-16">
            <div class="flex items-center justify-center space-x-4 mb-6">
                <div class="w-20 h-0.5 bg-gradient-to-r from-transparent to-teal-500"></div>
                <div
                    class="w-12 h-12 bg-gradient-to-br from-teal-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg">
                    <i class="fas fa-question-circle text-white text-xl"></i>
                </div>
                <div class="w-20 h-0.5 bg-gradient-to-l from-transparent to-blue-500"></div>
            </div>

            <h2 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6 leading-tight">
                Frequently Asked
                <span class="bg-gradient-to-r from-teal-600 to-blue-600 bg-clip-text text-transparent">Questions</span>
            </h2>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed mb-8">
                Find quick answers to common questions about Beyond Borders visa services. Can't find what you're
                looking for? Our support team is here to help!
            </p>

            <!-- FAQ Search Bar -->
            <div class="max-w-lg mx-auto relative">
                <div class="relative">
                    <input type="text" id="faq-search" placeholder="Search FAQs..."
                        class="w-full px-6 py-4 pl-14 bg-white border-2 border-gray-200 rounded-2xl shadow-lg focus:border-teal-500 focus:ring-4 focus:ring-teal-100 transition-all duration-300 text-gray-700 placeholder-gray-400">
                    <div class="absolute left-5 top-1/2 transform -translate-y-1/2">
                        <i class="fas fa-search text-gray-400"></i>
                    </div>
                    <div id="search-clear"
                        class="absolute right-5 top-1/2 transform -translate-y-1/2 cursor-pointer opacity-0 transition-opacity duration-300">
                        <i class="fas fa-times text-gray-400 hover:text-gray-600"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- FAQ Categories Pills -->
        <div class="flex flex-wrap justify-center gap-3 mb-12">
            <button class="faq-category-pill active" data-category="all">
                <i class="fas fa-list mr-2"></i>All Questions
            </button>
            <button class="faq-category-pill" data-category="general">
                <i class="fas fa-info-circle mr-2"></i>General
            </button>
            <button class="faq-category-pill" data-category="documents">
                <i class="fas fa-file-alt mr-2"></i>Documents
            </button>
            <button class="faq-category-pill" data-category="fees">
                <i class="fas fa-dollar-sign mr-2"></i>Fees & Payment
            </button>
            <button class="faq-category-pill" data-category="support">
                <i class="fas fa-headset mr-2"></i>Support
            </button>
        </div>

        <!-- Enhanced FAQ Items -->
        <div class="space-y-6" id="faq-container">
            <!-- FAQ Item 1 -->
            <div class="faq-item-enhanced" data-category="general"
                data-keywords="services visa applications immigration consulting document verification travel insurance">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-teal-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-briefcase text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-teal-600 transition-colors duration-300">
                                        What services do you offer?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Our comprehensive visa and immigration
                                        services</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-teal-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-teal-50 to-blue-50 rounded-2xl p-6 border border-teal-100">
                                <p class="text-gray-700 leading-relaxed mb-4">
                                    Beyond Borders specializes in providing assistance with visa applications,
                                    immigration consulting, document verification, travel insurance, and pre-departure
                                    briefings. Our services cover tourist, business, and other visa types.
                                </p>
                                <div class="flex flex-wrap gap-2">
                                    <span
                                        class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-teal-100 text-teal-800">
                                        <i class="fas fa-passport mr-1"></i>Visa Applications
                                    </span>
                                    <span
                                        class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                        <i class="fas fa-user-tie mr-1"></i>Immigration Consulting
                                    </span>
                                    <span
                                        class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800">
                                        <i class="fas fa-shield-alt mr-1"></i>Travel Insurance
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Item 2 -->
            <div class="faq-item-enhanced" data-category="general"
                data-keywords="countries USA UK Canada Schengen Australia New Zealand UAE">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-globe text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors duration-300">
                                        Which countries do you provide visa services for?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Our global coverage and destinations</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-blue-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-100">
                                <p class="text-gray-700 leading-relaxed mb-4">
                                    We currently assist with visa processing for countries including the USA, UK,
                                    Canada, Schengen (Europe), Australia, New Zealand, UAE, and more. Please contact us
                                    for your specific destination.
                                </p>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mt-4">
                                    <div class="text-center p-3 bg-white rounded-xl shadow-sm">
                                        <div class="text-2xl">ðŸ‡ºðŸ‡¸</div>
                                        <div class="text-sm text-gray-600">USA</div>
                                    </div>
                                    <div class="text-center p-3 bg-white rounded-xl shadow-sm">
                                        <div class="text-2xl">ðŸ‡¬ðŸ‡§</div>
                                        <div class="text-sm text-gray-600">UK</div>
                                    </div>
                                    <div class="text-center p-3 bg-white rounded-xl shadow-sm">
                                        <div class="text-2xl">ðŸ‡¨ðŸ‡¦</div>
                                        <div class="text-sm text-gray-600">Canada</div>
                                    </div>
                                    <div class="text-center p-3 bg-white rounded-xl shadow-sm">
                                        <div class="text-2xl">ðŸ‡ªðŸ‡º</div>
                                        <div class="text-sm text-gray-600">Schengen</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Item 3 -->
            <div class="faq-item-enhanced" data-category="general"
                data-keywords="processing time visa application duration embassy timeline">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-slate-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-clock text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-indigo-600 transition-colors duration-300">
                                        How long does the visa process take?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Processing times and expectations</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-indigo-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-indigo-50 to-slate-50 rounded-2xl p-6 border border-indigo-100">
                                <p class="text-gray-700 leading-relaxed mb-4">
                                    Processing times vary by country and visa type. On average, it can take anywhere
                                    from 2 days to 4 weeks. We provide estimated timelines based on current embassy
                                    processing trends.
                                </p>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                                    <div class="text-center p-4 bg-white rounded-xl shadow-sm">
                                        <div class="text-2xl font-bold text-green-600">2-5 Days</div>
                                        <div class="text-sm text-gray-600">Express Processing</div>
                                    </div>
                                    <div class="text-center p-4 bg-white rounded-xl shadow-sm">
                                        <div class="text-2xl font-bold text-blue-600">1-2 Weeks</div>
                                        <div class="text-sm text-gray-600">Standard Processing</div>
                                    </div>
                                    <div class="text-center p-4 bg-white rounded-xl shadow-sm">
                                        <div class="text-2xl font-bold text-orange-600">2-4 Weeks</div>
                                        <div class="text-sm text-gray-600">Regular Processing</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- FAQ Item 4 -->
            <div class="faq-item-enhanced" data-category="general"
                data-keywords="apply from different city state remote online digital anywhere whatsapp email phone">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-teal-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-house-laptop text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-teal-600 transition-colors duration-300">
                                        Can I apply for a visa through your company even if Iâ€™m in a different
                                        city/state?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Digital-first assistance from anywhere</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-teal-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-teal-50 to-blue-50 rounded-2xl p-6 border border-teal-100">
                                <p class="text-gray-700 leading-relaxed">
                                    Yes. We operate digitally and provide end-to-end assistance via email, phone, and
                                    WhatsAppâ€”no matter where you are located.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Item 5 -->
            <div class="faq-item-enhanced" data-category="general"
                data-keywords="guarantee approval success assured embassy consulate decision">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-shield-alt text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors duration-300">
                                        Do you guarantee visa approval?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Transparency about outcomes</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-blue-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-100">
                                <p class="text-gray-700 leading-relaxed">
                                    No. Approval is solely at the discretion of the consulate/embassy. We ensure your
                                    documentation is complete and professionally prepared to maximize your chances.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Item 6 -->
            <div class="faq-item-enhanced" data-category="documents"
                data-keywords="documents required checklist tourist business student passport photos bank statements itinerary invitation employment study insurance">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-teal-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-file-alt text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-teal-600 transition-colors duration-300">
                                        What documents are required for a tourist/business/student visa?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Typical requirements (vary by country)</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-teal-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-teal-50 to-blue-50 rounded-2xl p-6 border border-teal-100">
                                <p class="text-gray-700 leading-relaxed mb-4">While requirements vary, common documents
                                    include:</p>
                                <ul class="list-disc list-inside text-gray-700 space-y-1">
                                    <li>Valid passport</li>
                                    <li>Completed application form</li>
                                    <li>Photographs (as per specifications)</li>
                                    <li>Financial statements</li>
                                    <li>Travel itinerary or invitation letter</li>
                                    <li>Employment/study proof</li>
                                    <li>Travel insurance (for some visas)</li>
                                </ul>
                                <p class="text-gray-700 leading-relaxed mt-4">We provide a customized checklist for each
                                    applicant. It differs case by case.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Item 7 -->
            <div class="faq-item-enhanced" data-category="documents"
                data-keywords="help prepare documents form filling cover letter itinerary translation verification">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-edit text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors duration-300">
                                        Can you help me prepare my documents?</h3>
                                    <p class="text-sm text-gray-500 mt-1">End-to-end documentation support</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-blue-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-100">
                                <p class="text-gray-700 leading-relaxed">Absolutely. We assist with form filling, cover
                                    letters, itinerary creation, financial planning, verification, and translations
                                    where needed.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Item 8 -->
            <div class="faq-item-enhanced" data-category="documents"
                data-keywords="visa rejected refusal reapply appeal reconsideration next attempt">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-slate-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-times-circle text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-indigo-600 transition-colors duration-300">
                                        What if my visa is rejected?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Guidance for re-application or appeal</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-indigo-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-indigo-50 to-slate-50 rounded-2xl p-6 border border-indigo-100">
                                <p class="text-gray-700 leading-relaxed">We review the refusal reasons and advise on the
                                    best next stepsâ€”reapplying, appealing if applicable, and strengthening your
                                    documentation.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Item 9 -->
            <div class="faq-item-enhanced" data-category="fees"
                data-keywords="fees charges cost price service fee visa fee quote">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-teal-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-rupee-sign text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-teal-600 transition-colors duration-300">
                                        How much do you charge for your services?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Pricing and components</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-teal-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-teal-50 to-blue-50 rounded-2xl p-6 border border-teal-100">
                                <p class="text-gray-700 leading-relaxed">Fees vary by visa type and case complexity.
                                    Embassy/consulate visa fees are separate and non-refundable. Contact us for a
                                    tailored quote.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Item 10 -->
            <div class="faq-item-enhanced" data-category="fees"
                data-keywords="refund refundable policy consultation processing non-refundable">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-receipt text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors duration-300">
                                        Is your service fee refundable?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Refund policy</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-blue-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-100">
                                <p class="text-gray-700 leading-relaxed">Our consultation and processing fees are
                                    non-refundable, as they cover the time and expertise invested regardless of the
                                    outcome.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Item 11 -->
            <div class="faq-item-enhanced" data-category="support"
                data-keywords="track status updates follow up tracking">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-slate-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-stream text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-indigo-600 transition-colors duration-300">
                                        Will you help me track my visa status?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Proactive updates</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-indigo-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-indigo-50 to-slate-50 rounded-2xl p-6 border border-indigo-100">
                                <p class="text-gray-700 leading-relaxed">Yes, we track your application and share timely
                                    updates throughout the process.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Item 12 -->
            <div class="faq-item-enhanced" data-category="support"
                data-keywords="urgent emergency fast track express rush appointment">
                <div class="faq-card">
                    <button class="faq-question-enhanced group w-full text-left">
                        <div class="flex items-center justify-between p-8">
                            <div class="flex items-center space-x-4">
                                <div
                                    class="w-12 h-12 bg-gradient-to-br from-teal-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <i class="fas fa-bolt text-white"></i>
                                </div>
                                <div>
                                    <h3
                                        class="text-xl font-bold text-gray-900 group-hover:text-teal-600 transition-colors duration-300">
                                        Can I contact you for urgent/emergency visa requests?</h3>
                                    <p class="text-sm text-gray-500 mt-1">Fast-track support (subject to embassy
                                        options)</p>
                                </div>
                            </div>
                            <div class="faq-icon-container">
                                <i
                                    class="fas fa-chevron-down faq-chevron text-gray-400 group-hover:text-teal-600 transition-all duration-300"></i>
                            </div>
                        </div>
                    </button>
                    <div class="faq-answer-enhanced">
                        <div class="px-8 pb-8">
                            <div
                                class="bg-gradient-to-r from-teal-50 to-blue-50 rounded-2xl p-6 border border-teal-100">
                                <p class="text-gray-700 leading-relaxed">Yes, we handle urgent cases where possible,
                                    including express/fastâ€‘track options when offered by the embassy.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- No Results Message -->
        <div id="no-results" class="text-center py-12 hidden">
            <div
                class="w-24 h-24 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full flex items-center justify-center mx-auto mb-6">
                <i class="fas fa-search text-gray-500 text-2xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-900 mb-2">No questions found</h3>
            <p class="text-gray-600">Try adjusting your search terms or browse all categories</p>
        </div>

        <!-- Contact Support CTA -->
        <div class="mt-16 text-center">
            <div class="bg-gradient-to-r from-teal-600 to-blue-600 rounded-3xl p-8 text-white relative overflow-hidden">
                <div class="absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full -mr-16 -mt-16"></div>
                <div class="absolute bottom-0 left-0 w-24 h-24 bg-white opacity-5 rounded-full -ml-12 -mb-12"></div>
                <div class="relative z-10">
                    <h3 class="text-2xl font-bold mb-4">Still have questions?</h3>
                    <p class="text-blue-100 mb-6 max-w-2xl mx-auto">Our expert team is available 24/7 to help you with
                        any visa-related queries. Get personalized assistance for your travel needs.</p>
                    <a href="#"
                        class="inline-flex items-center px-8 py-4 bg-white text-teal-600 font-semibold rounded-2xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 group">
                        <i class="fas fa-comments mr-3 group-hover:scale-110 transition-transform duration-300"></i>
                        <span>Contact Us</span>
                        <i
                            class="fas fa-arrow-right ml-3 group-hover:translate-x-1 transition-transform duration-300"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Load carousel config and initialize
        fetch('/static/js/carousel-config.json')
            .then(response => response.json())
            .then(config => {
                initializeCarousel(config);
            })
            .catch(error => {
                console.error('Error loading carousel config:', error);
                // Fallback to default config
                const defaultConfig = {
                    countries: [
                        {
                            name: "Japan",
                            backgroundImage: "https://images.unsplash.com/photo-1508179499299-2643424fae56?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                            url: "/countries/japan"
                        },
                        {
                            name: "Singapore",
                            backgroundImage: "https://images.unsplash.com/photo-1657445003648-aa6ed5fc5d63?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                            url: "/countries/singapore"
                        },
                        {
                            name: "South Korea",
                            backgroundImage: "https://images.unsplash.com/photo-1551685314-8167cf1cba72?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                            url: "/countries/south-korea"
                        },
                        {
                            name: "Thailand",
                            backgroundImage: "https://plus.unsplash.com/premium_photo-1707793862259-78c4112475d1?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                            url: "/countries/thailand"
                        },
                        {
                            name: "Vietnam",
                            backgroundImage: "https://images.unsplash.com/photo-1560979724-f86caa17a2ed?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                            url: "/countries/vietnam"
                        },
                        {
                            name: "UAE",
                            backgroundImage: "https://plus.unsplash.com/premium_photo-1694475187704-de2d1602b36b?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                            url: "/countries/united-arab-emirates"
                        }
                    ]
                };
                initializeCarousel(defaultConfig);
            });

        // Load countries onto home page
        loadHomeCountries();
        // Init FAQ
        initializeFAQ();
    });

    async function loadTrendingVisas() {
        try {
            // Prefer featured, fallback to all
            let res = await fetch('/api/countries/featured?limit=12');
            let countries = [];
            if (res.ok) {
                countries = await res.json();
            }
            if (!Array.isArray(countries) || countries.length === 0) {
                const allRes = await fetch('/api/countries/?limit=100');
                countries = await allRes.json();
            }
            // Build cards
            const track = document.getElementById('trendingTrack');
            const items = (countries || []).slice(0, 12).map(c => {
                const hero = (c.hero_image_url && c.hero_image_url.trim() !== '') ? c.hero_image_url : 'https://images.unsplash.com/photo-1534067783941-51c9c23ecefd?auto=format&fit=crop&w=1200&q=80';
                const badge = c.visa_required ? '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800 border border-yellow-300">Visa Required</span>'
                    : '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-emerald-100 text-emerald-800 border border-emerald-300">Visa Free</span>';
                return `
            <a href="/countries/${c.id}" class="trending-card bg-white rounded-2xl p-4 border border-gray-100 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300 snap-start">
                <div class="flex items-center gap-3">
                    <div class="thumb"><img src="${hero}" alt="${c.name}"></div>
                    <div class="flex-1">
                        <div class="flex items-center gap-2">
                            <span class="flag">${c.flag || ''}</span>
                            <div class="font-semibold text-gray-900">${c.name}</div>
                        </div>
                        <div class="mt-1 flex items-center justify-between">
                            <div class="text-xs text-gray-500">${c.region || ''}</div>
                            ${badge}
                        </div>
                    </div>
                </div>
            </a>`;
            }).join('');
            track.innerHTML = items;

            // Duplicate for seamless loop (keep logic if used elsewhere)
            track.innerHTML += track.innerHTML;
        } catch (e) {
            console.error('Trending visas failed', e);
        }
    }

    function initializeCarousel(config) {
        const hero = document.querySelector('.hero-klook');
        const carousel = document.querySelector('.city-carousel');
        let currentIndex = 0;
        let autoSlideInterval;
        let isUserInteracting = false;

        // Create city items from config
        carousel.innerHTML = config.countries.map((country, index) =>
            `<a href="${country.url}" class="city-item ${index === 0 ? 'active' : ''}" data-city="${country.name}" data-bg="${country.backgroundImage}" style="text-decoration: none; color: inherit;">${country.name}</a>`
        ).join('');

        const cityItems = document.querySelectorAll('.city-item');

        // Set initial background
        const initialBg = cityItems[currentIndex].getAttribute('data-bg');
        hero.style.backgroundImage = `url('${initialBg}')`;

        // --- Auto Carousel Functionality ---
        function startAutoSlide() {
            autoSlideInterval = setInterval(() => {
                if (!isUserInteracting) {
                    const nextIndex = (currentIndex + 1) % cityItems.length;
                    setActiveCity(nextIndex);
                }
            }, 3000); // 3 seconds
        }

        function stopAutoSlide() {
            if (autoSlideInterval) {
                clearInterval(autoSlideInterval);
            }
        }

        function resetAutoSlide() {
            stopAutoSlide();
            setTimeout(() => {
                if (!isUserInteracting) {
                    startAutoSlide();
                }
            }, 2000); // Wait 2 seconds after user interaction before resuming auto-slide
        }

        // --- Live Search ---
        const searchInput = document.getElementById('search-input');
        const searchResults = document.getElementById('search-results-klook');
        let debounceTimer;

        searchInput.addEventListener('input', function () {
            clearTimeout(debounceTimer);
            const query = this.value;

            if (query.length < 2) {
                searchResults.style.display = 'none';
                return;
            }

            searchResults.innerHTML = `
            <div class="search-result-item">
                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
                <div>
                    <strong>Searching...</strong>
                    <p>Finding countries matching "${query}"</p>
                </div>
            </div>
        `;
            searchResults.style.display = 'block';

            debounceTimer = setTimeout(() => {
                fetch(`/api/countries/search?q=${query}&limit=20`)
                    .then(response => response.json())
                    .then(data => {
                        searchResults.innerHTML = '';
                        if (data.length > 0) {
                            data.slice(0, 4).forEach(country => {
                                const item = document.createElement('a');
                                item.href = `/countries/${country.id}`;
                                item.classList.add('search-result-item');
                                item.innerHTML = `
                                <div class="flag">${country.flag}</div>
                                <div>
                                    <strong>${country.name}</strong>
                                    <p>${country.summary.length > 80 ? country.summary.substring(0, 80) + '...' : country.summary}</p>
                                </div>
                            `;
                                searchResults.appendChild(item);
                            });

                            if (data.length > 4) {
                                const seeAllItem = document.createElement('a');
                                seeAllItem.href = `/search?q=${encodeURIComponent(query)}`;
                                seeAllItem.classList.add('search-result-item', 'see-all-results');
                                seeAllItem.innerHTML = `
                                <div class="see-all-icon">
                                    <i class="fas fa-search"></i>
                                </div>
                                <div>
                                    <strong>See all results for "${query}"</strong>
                                    <p>View all ${data.length}+ countries matching your search</p>
                                </div>
                            `;
                                searchResults.appendChild(seeAllItem);
                            }

                            searchResults.style.display = 'block';
                        } else {
                            const noResultsItem = document.createElement('div');
                            noResultsItem.classList.add('search-result-item', 'no-results');
                            noResultsItem.innerHTML = `
                            <div class="no-results-icon">
                                <i class="fas fa-search"></i>
                            </div>
                            <div>
                                <strong>No countries found</strong>
                                <p>Try adjusting your search terms</p>
                            </div>
                        `;
                            searchResults.appendChild(noResultsItem);
                            searchResults.style.display = 'block';
                        }
                    })
                    .catch(error => {
                        console.error('Search error:', error);
                        searchResults.style.display = 'none';
                    });
            }, 300);
        });

        document.addEventListener('click', function (e) {
            if (!e.target.closest('.search-box-klook')) {
                searchResults.style.display = 'none';
            }
        });

        // --- City click functionality ---
        cityItems.forEach((item, index) => {
            item.addEventListener('click', function (e) {
                // Prevent immediate navigation for carousel interaction
                e.preventDefault();

                isUserInteracting = true;
                setActiveCity(index);
                resetAutoSlide();

                // Navigate to country page after a short delay
                setTimeout(() => {
                    window.location.href = this.href;
                }, 500); // 500ms delay to allow carousel interaction

                setTimeout(() => {
                    isUserInteracting = false;
                }, 1000);
            });
        });

        function setActiveCity(index) {
            cityItems[currentIndex].classList.remove('active');
            cityItems[currentIndex].classList.add('distant');

            currentIndex = index;
            const targetBg = cityItems[currentIndex].getAttribute('data-bg');
            hero.style.backgroundImage = `url('${targetBg}')`;

            cityItems.forEach((item, i) => {
                item.classList.remove('active', 'semi-active', 'distant');
                if (i === currentIndex) {
                    item.classList.add('active');
                } else if (Math.abs(i - currentIndex) === 1 ||
                    (currentIndex === 0 && i === cityItems.length - 1) ||
                    (currentIndex === cityItems.length - 1 && i === 0)) {
                    item.classList.add('semi-active');
                } else {
                    item.classList.add('distant');
                }
            });
        }

        // Start auto-slide
        startAutoSlide();

        // Handle hover interactions
        carousel.addEventListener('mouseenter', () => {
            isUserInteracting = true;
            stopAutoSlide();
        });

        carousel.addEventListener('mouseleave', () => {
            isUserInteracting = false;
            resetAutoSlide();
        });
    }

    // FAQ Accordion
    function initializeFAQ() {
        const faqItems = document.querySelectorAll('.faq-item-enhanced');
        const faqQuestions = document.querySelectorAll('.faq-question-enhanced');
        const searchInput = document.getElementById('faq-search');
        const searchClear = document.getElementById('search-clear');
        const categoryPills = document.querySelectorAll('.faq-category-pill');
        const noResults = document.getElementById('no-results');
        const faqContainer = document.getElementById('faq-container');

        // Accordion
        faqQuestions.forEach((question) => {
            question.addEventListener('click', (event) => {
                const faqItem = question.closest('.faq-item-enhanced');
                const answer = faqItem.querySelector('.faq-answer-enhanced');
                const isOpen = answer.classList.contains('open');

                document.querySelectorAll('.faq-answer-enhanced').forEach(ans => {
                    if (ans !== answer) {
                        ans.classList.remove('open');
                        ans.closest('.faq-item-enhanced').classList.remove('active');
                    }
                });

                answer.classList.toggle('open', !isOpen);
                faqItem.classList.toggle('active', !isOpen);
            });
        });

        // Search
        if (searchInput) {
            searchInput.addEventListener('input', function () {
                const query = this.value.toLowerCase().trim();
                searchClear.style.opacity = query.length > 0 ? 1 : 0;
                filterFAQs(query);
            });
        }
        if (searchClear) {
            searchClear.addEventListener('click', function () {
                if (!searchInput) return;
                searchInput.value = '';
                searchClear.style.opacity = 0;
                filterFAQs('');
            });
        }

        // Category filtering
        categoryPills.forEach(pill => {
            pill.addEventListener('click', function () {
                categoryPills.forEach(p => p.classList.remove('active'));
                this.classList.add('active');
                filterByCategory(this.getAttribute('data-category'));
            });
        });

        function filterFAQs(query) {
            let visibleCount = 0;
            faqItems.forEach((item, index) => {
                const keywords = (item.getAttribute('data-keywords') || '').toLowerCase();
                const title = (item.querySelector('h3')?.textContent || '').toLowerCase();
                const content = (item.querySelector('.faq-answer-enhanced p')?.textContent || '').toLowerCase();
                const matches = keywords.includes(query) || title.includes(query) || content.includes(query);
                if (matches || query === '') {
                    item.classList.remove('hidden');
                    item.style.animationDelay = (index * 0.05) + 's';
                    visibleCount++;
                } else {
                    item.classList.add('hidden');
                }
            });
            if (noResults && faqContainer) {
                noResults.classList.toggle('hidden', !(visibleCount === 0 && query !== ''));
                faqContainer.style.display = visibleCount === 0 && query !== '' ? 'none' : 'block';
            }
        }

        function filterByCategory(category) {
            let visibleCount = 0;
            faqItems.forEach((item, index) => {
                const itemCategory = item.getAttribute('data-category');
                const matches = category === 'all' || itemCategory === category;
                item.classList.toggle('hidden', !matches);
                if (matches) visibleCount++;
            });
            if (searchInput) searchInput.value = '';
            if (searchClear) searchClear.style.opacity = 0;
            if (noResults && faqContainer) {
                noResults.classList.toggle('hidden', visibleCount !== 0);
                faqContainer.style.display = visibleCount === 0 ? 'none' : 'block';
            }
        }
    }

    // --- Home Countries rendering (compact, no filters) ---
    async function loadHomeCountries() {
        const grid = document.getElementById('homeCountriesGrid');
        const carouselTrack = document.getElementById('carouselTrack');
        const carouselDots = document.getElementById('carouselDots');
        const carousel = document.getElementById('homeCountriesCarousel');
        const loader = document.getElementById('homeCountriesLoading');

        try {
            const response = await fetch('/api/countries/?limit=100');
            const countries = await response.json();
            const html = (countries || []).map(createCountryCardHome).join('');

            // Populate desktop grid
            grid.innerHTML = html;

            // Populate mobile carousel
            carouselTrack.innerHTML = html;

            // Create carousel dots
            const dotsHtml = (countries || []).map((_, index) =>
                `<div class="carousel-dot ${index === 0 ? 'active' : ''}" data-index="${index}"></div>`
            ).join('');
            carouselDots.innerHTML = dotsHtml;

            // Hide loader and show content
            loader.style.display = 'none';
            grid.style.display = 'grid';
            carousel.style.display = 'block';

            // Initialize carousel functionality
            initializeCarousel(carouselTrack, carouselDots);

        } catch (e) {
            console.error('Error loading home countries', e);
            if (loader) loader.innerHTML = '<div class="text-center"><i class="fas fa-exclamation-triangle text-4xl text-red-400 mb-4"></i><h3 class="text-xl font-semibold text-gray-900 mb-2">Error Loading Countries</h3><p class="text-gray-600">Please try refreshing the page.</p></div>';
        }
    }

    function initializeCarousel(track, dotsContainer) {
        const container = track.parentElement;
        const dots = dotsContainer.querySelectorAll('.carousel-dot');
        const cards = track.querySelectorAll('.country-card');

        if (cards.length === 0) return;

        // Update active dot based on scroll position
        let scrollTimeout;
        container.addEventListener('scroll', () => {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                const scrollLeft = container.scrollLeft;
                const cardWidth = cards[0].offsetWidth + 16; // card width + gap
                const activeIndex = Math.round(scrollLeft / cardWidth);

                dots.forEach((dot, index) => {
                    dot.classList.toggle('active', index === activeIndex);
                });
            }, 100);
        });

        // Click on dots to scroll
        dots.forEach((dot, index) => {
            dot.addEventListener('click', () => {
                const cardWidth = cards[0].offsetWidth + 16;
                container.scrollTo({
                    left: cardWidth * index,
                    behavior: 'smooth'
                });
            });
        });
    }


    function createCountryCardHome(country) {
        const countryId = country.id;
        if (!countryId) return '';
        const fallbackHero = 'https://images.unsplash.com/photo-1534067783941-51c9c23ecefd?auto=format&fit=crop&w=1350&q=80';
        const hero = (country.hero_image_url && country.hero_image_url.trim() !== '') ? country.hero_image_url : fallbackHero;
        return `
        <a href="/countries/${countryId}" class="country-card">
            <div class="country-media" style="background-image: url('${hero}')">
                <div class="country-media-overlay"></div>
                <div class="country-flag-bubble">${country.flag || ''}</div>
                <span class="visa-status-badge ${country.visa_required ? 'visa-status-required' : 'visa-status-free'}">
                    <i class="fas ${country.visa_required ? 'fa-passport' : 'fa-check-circle'}"></i>
                    ${country.visa_required ? 'Visa Required' : 'Visa Free'}
                </span>
            </div>
            <div class="country-card-content">
                <div class="country-meta">
                    <h3 class="country-title">${country.name}</h3>
                    <span class="country-region-chip">${country.region || ''}</span>
                </div>
            </div>
        </a>
    `;
    }

</script>
{% endblock %}